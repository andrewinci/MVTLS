<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<title>Advanced Programming : TLS handshake: src/TLS.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Advanced Programming : TLS handshake
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">TLS.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="_t_l_s_8h_source.html">TLS.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for TLS.c:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c__incl.png" border="0" usemap="#src_2_t_l_s_8c" alt=""/></div>
<map name="src_2_t_l_s_8c" id="src_2_t_l_s_8c">
<area shape="rect" id="node2" href="_t_l_s_8h.html" title="TLS.h" alt="" coords="309,80,365,107"/>
<area shape="rect" id="node5" href="_server_client_handshake_protocol_8h.html" title="ServerClientHandshakeProtocol.h" alt="" coords="683,155,905,181"/>
<area shape="rect" id="node9" href="_server_client_record_protocol_8h.html" title="ServerClientRecordProtocol.h" alt="" coords="238,229,436,256"/>
<area shape="rect" id="node24" href="_crypto_8h.html" title="Crypto.h" alt="" coords="1383,155,1455,181"/>
<area shape="rect" id="node16" href="_t_l_s_constants_8h.html" title="TLSConstants.h" alt="" coords="1161,304,1279,331"/>
<area shape="rect" id="node18" href="_server_client_hello_8h.html" title="ServerClientHello.h" alt="" coords="1061,229,1197,256"/>
<area shape="rect" id="node20" href="_certificate_8h.html" title="Certificate.h" alt="" coords="748,229,841,256"/>
<area shape="rect" id="node23" href="_server_client_key_exchange_8h.html" title="ServerClientKeyExchange.h" alt="" coords="1324,229,1513,256"/>
<area shape="rect" id="node10" href="_server_client_transport_protocol_8h.html" title="ServerClientTransportProtocol.h" alt="" coords="149,304,360,331"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a12a63a5becca8f85a59f6ac0f4d9c553"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_t_l_s_8c.html#a12a63a5becca8f85a59f6ac0f4d9c553">backup_handshake</a> (<a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *<a class="el" href="server_8c.html#aa8eef32066e04e25183a0cc549992c54">TLS_param</a>, <a class="el" href="structhandshake__t.html">handshake_t</a> *h)</td></tr>
<tr class="separator:a12a63a5becca8f85a59f6ac0f4d9c553"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c6bc0a015a0a78cb508614995b9172e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structhandshake__t.html">handshake_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_t_l_s_8c.html#a7c6bc0a015a0a78cb508614995b9172e">make_client_hello</a> (unsigned char *client_random, <a class="el" href="structcipher__suite__t.html">cipher_suite_t</a> <a class="el" href="_t_l_s_constants_8c.html#ace4b851fd953c51fe7b0ada522a95ae3">cipher_suite_list</a>[], int cipher_suite_len)</td></tr>
<tr class="separator:a7c6bc0a015a0a78cb508614995b9172e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef2a72a9807aac60336cd3febe51a130"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_t_l_s_8c.html#aef2a72a9807aac60336cd3febe51a130">make_RSA_client_key_exchange</a> (<a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *<a class="el" href="server_8c.html#aa8eef32066e04e25183a0cc549992c54">TLS_param</a>, <a class="el" href="structclient__key__exchange__t.html">client_key_exchange_t</a> *client_key_ex)</td></tr>
<tr class="separator:aef2a72a9807aac60336cd3febe51a130"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace7876fa0df923e8b3c924a7a046a1ff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_t_l_s_8c.html#ace7876fa0df923e8b3c924a7a046a1ff">make_DHE_client_key_exchange</a> (<a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *<a class="el" href="server_8c.html#aa8eef32066e04e25183a0cc549992c54">TLS_param</a>, <a class="el" href="structclient__key__exchange__t.html">client_key_exchange_t</a> *client_key_ex)</td></tr>
<tr class="separator:ace7876fa0df923e8b3c924a7a046a1ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f7128cf62e8491d70cf2585cf901c4c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_t_l_s_8c.html#a6f7128cf62e8491d70cf2585cf901c4c">make_ECDHE_client_key_exchange</a> (<a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *<a class="el" href="server_8c.html#aa8eef32066e04e25183a0cc549992c54">TLS_param</a>, <a class="el" href="structclient__key__exchange__t.html">client_key_exchange_t</a> *client_key_ex)</td></tr>
<tr class="separator:a6f7128cf62e8491d70cf2585cf901c4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3bb4e3f75fb84baa35cd0931381dfe0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structhandshake__t.html">handshake_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_t_l_s_8c.html#ab3bb4e3f75fb84baa35cd0931381dfe0">make_client_key_exchange</a> (<a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *<a class="el" href="server_8c.html#aa8eef32066e04e25183a0cc549992c54">TLS_param</a>, uint16_t key_ex_alg)</td></tr>
<tr class="separator:ab3bb4e3f75fb84baa35cd0931381dfe0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bed323f749e27db36fd6ab2a3e64c4a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structrecord__t.html">record_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_t_l_s_8c.html#a5bed323f749e27db36fd6ab2a3e64c4a">make_change_cipher_spec</a> ()</td></tr>
<tr class="separator:a5bed323f749e27db36fd6ab2a3e64c4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae149244e09cbbd2180bc4c5fc6d0a924"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structhandshake__t.html">handshake_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_t_l_s_8c.html#ae149244e09cbbd2180bc4c5fc6d0a924">make_finished_message</a> (<a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *<a class="el" href="server_8c.html#aa8eef32066e04e25183a0cc549992c54">TLS_param</a>)</td></tr>
<tr class="separator:ae149244e09cbbd2180bc4c5fc6d0a924"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a035a830fd89c6c7af60809197d81ea29"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structhandshake__t.html">handshake_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_t_l_s_8c.html#a035a830fd89c6c7af60809197d81ea29">make_server_hello</a> (<a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *<a class="el" href="server_8c.html#aa8eef32066e04e25183a0cc549992c54">TLS_param</a>, <a class="el" href="structserver__client__hello__t.html">server_client_hello_t</a> *client_hello)</td></tr>
<tr class="separator:a035a830fd89c6c7af60809197d81ea29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fd919275c5d6d3e6578c480cc62a8ce"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structhandshake__t.html">handshake_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_t_l_s_8c.html#a6fd919275c5d6d3e6578c480cc62a8ce">make_certificate</a> (<a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *<a class="el" href="server_8c.html#aa8eef32066e04e25183a0cc549992c54">TLS_param</a>)</td></tr>
<tr class="separator:a6fd919275c5d6d3e6578c480cc62a8ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a359e2b0b51c61744f7a70b5888d8c2db"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdhe__server__key__exchange__t.html">dhe_server_key_exchange_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_t_l_s_8c.html#a359e2b0b51c61744f7a70b5888d8c2db">make_DHE_server_key_exchange</a> (<a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *<a class="el" href="server_8c.html#aa8eef32066e04e25183a0cc549992c54">TLS_param</a>)</td></tr>
<tr class="separator:a359e2b0b51c61744f7a70b5888d8c2db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade6994e7ea30d8b5b89b2cd551101db4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structecdhe__server__key__exchange__t.html">ecdhe_server_key_exchange_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_t_l_s_8c.html#ade6994e7ea30d8b5b89b2cd551101db4">make_ECDHE_server_key_exchange</a> (<a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *<a class="el" href="server_8c.html#aa8eef32066e04e25183a0cc549992c54">TLS_param</a>)</td></tr>
<tr class="separator:ade6994e7ea30d8b5b89b2cd551101db4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a902d940508d7080023ef072b2667a143"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structhandshake__t.html">handshake_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_t_l_s_8c.html#a902d940508d7080023ef072b2667a143">make_server_key_exchange</a> (<a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *<a class="el" href="server_8c.html#aa8eef32066e04e25183a0cc549992c54">TLS_param</a>)</td></tr>
<tr class="separator:a902d940508d7080023ef072b2667a143"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af98aa49e2563d588c366ef1712de925a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structhandshake__t.html">handshake_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_t_l_s_8c.html#af98aa49e2563d588c366ef1712de925a">make_server_hello_done</a> ()</td></tr>
<tr class="separator:af98aa49e2563d588c366ef1712de925a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>SSL/TLS Project</p>
<p>This file provide a set of function for the TLS handshake. The function are used for make TLS message for both server and client.</p>
<dl class="section date"><dt>Date</dt><dd>Created on 13/01/16. </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright © 2016 Alessandro Melloni, Andrea Francesco Vinci. All rights reserved. </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a12a63a5becca8f85a59f6ac0f4d9c553"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void backup_handshake </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *&#160;</td>
          <td class="paramname"><em>TLS_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structhandshake__t.html">handshake_t</a> *&#160;</td>
          <td class="paramname"><em>h</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Append the handshake h to the handshake_messages field of TLS_param</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TLS_param</td><td>: connection parameters </td></tr>
    <tr><td class="paramname">h</td><td>: the handshake to append </td></tr>
  </table>
  </dd>
</dl>

<p>Referenced by <a class="el" href="client_8c.html#aed2d0a7b3d9f68efed058f1bc0768e95">do_handshake()</a>, and <a class="el" href="client_8c.html#a779b051aa3cf19358f7177780ce60f11">onPacketReceive()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_a12a63a5becca8f85a59f6ac0f4d9c553_cgraph.png" border="0" usemap="#_t_l_s_8c_a12a63a5becca8f85a59f6ac0f4d9c553_cgraph" alt=""/></div>
<map name="_t_l_s_8c_a12a63a5becca8f85a59f6ac0f4d9c553_cgraph" id="_t_l_s_8c_a12a63a5becca8f85a59f6ac0f4d9c553_cgraph">
<area shape="rect" id="node2" href="_server_client_handshake_protocol_8c.html#a1f9226db59b1fe4f860122d082429f78" title="serialize_handshake" alt="" coords="192,5,336,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_a12a63a5becca8f85a59f6ac0f4d9c553_icgraph.png" border="0" usemap="#_t_l_s_8c_a12a63a5becca8f85a59f6ac0f4d9c553_icgraph" alt=""/></div>
<map name="_t_l_s_8c_a12a63a5becca8f85a59f6ac0f4d9c553_icgraph" id="_t_l_s_8c_a12a63a5becca8f85a59f6ac0f4d9c553_icgraph">
<area shape="rect" id="node2" href="client_8c.html#aed2d0a7b3d9f68efed058f1bc0768e95" title="do_handshake" alt="" coords="525,31,635,57"/>
<area shape="rect" id="node4" href="client_8c.html#a779b051aa3cf19358f7177780ce60f11" title="onPacketReceive" alt="" coords="192,31,317,57"/>
<area shape="rect" id="node3" href="client_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="683,31,733,57"/>
<area shape="rect" id="node5" href="_server_client_transport_protocol_8h.html#a018090dd0ba292fbef485142a080fa59" title="set_on_receive" alt="" coords="365,81,477,108"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6fd919275c5d6d3e6578c480cc62a8ce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structhandshake__t.html">handshake_t</a>* make_certificate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *&#160;</td>
          <td class="paramname"><em>TLS_param</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Make the certificate message for the server. That message depends on the authentication algorithm hence we require the connection parameters. The function also sets the certificate in the connection parameters for feature uses.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TLS_param</td><td>: connection parameters </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the certificate handshake message </dd></dl>

<p>Referenced by <a class="el" href="server_8c.html#a98d326f448510d53d67b27e5cbbad82d">onPacketReceive()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_a6fd919275c5d6d3e6578c480cc62a8ce_cgraph.png" border="0" usemap="#_t_l_s_8c_a6fd919275c5d6d3e6578c480cc62a8ce_cgraph" alt=""/></div>
<map name="_t_l_s_8c_a6fd919275c5d6d3e6578c480cc62a8ce_cgraph" id="_t_l_s_8c_a6fd919275c5d6d3e6578c480cc62a8ce_cgraph">
<area shape="rect" id="node2" href="_certificate_8c.html#a1eb2ef0668ed7bc45a2416b5b6a707f1" title="make_certificate_message" alt="" coords="174,5,354,32"/>
<area shape="rect" id="node3" href="_certificate_8c.html#a0939aba653417f0b516a6d6a2a102b3d" title="serialize_certificate\l_message" alt="" coords="196,57,332,98"/>
<area shape="rect" id="node4" href="_certificate_8c.html#a47cd7cd727cb5ed51f41bf165585a386" title="free_certificate_message" alt="" coords="179,123,349,149"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_a6fd919275c5d6d3e6578c480cc62a8ce_icgraph.png" border="0" usemap="#_t_l_s_8c_a6fd919275c5d6d3e6578c480cc62a8ce_icgraph" alt=""/></div>
<map name="_t_l_s_8c_a6fd919275c5d6d3e6578c480cc62a8ce_icgraph" id="_t_l_s_8c_a6fd919275c5d6d3e6578c480cc62a8ce_icgraph">
<area shape="rect" id="node2" href="server_8c.html#a98d326f448510d53d67b27e5cbbad82d" title="onPacketReceive" alt="" coords="173,5,299,32"/>
<area shape="rect" id="node3" href="server_8c.html#a92b39c23154f9435d52c1bd2babb4ad9" title="do_handshake" alt="" coords="347,5,456,32"/>
<area shape="rect" id="node4" href="server_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="504,5,555,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5bed323f749e27db36fd6ab2a3e64c4a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structrecord__t.html">record_t</a>* make_change_cipher_spec </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Make the change cipher spec record message. This message is simple and doesn't require any parameter.</p>
<dl class="section return"><dt>Returns</dt><dd>the change cipher spec record </dd></dl>

<p>Referenced by <a class="el" href="client_8c.html#a779b051aa3cf19358f7177780ce60f11">onPacketReceive()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_a5bed323f749e27db36fd6ab2a3e64c4a_icgraph.png" border="0" usemap="#_t_l_s_8c_a5bed323f749e27db36fd6ab2a3e64c4a_icgraph" alt=""/></div>
<map name="_t_l_s_8c_a5bed323f749e27db36fd6ab2a3e64c4a_icgraph" id="_t_l_s_8c_a5bed323f749e27db36fd6ab2a3e64c4a_icgraph">
<area shape="rect" id="node2" href="client_8c.html#a779b051aa3cf19358f7177780ce60f11" title="onPacketReceive" alt="" coords="240,5,365,32"/>
<area shape="rect" id="node3" href="client_8c.html#aed2d0a7b3d9f68efed058f1bc0768e95" title="do_handshake" alt="" coords="573,5,683,32"/>
<area shape="rect" id="node5" href="_server_client_transport_protocol_8h.html#a018090dd0ba292fbef485142a080fa59" title="set_on_receive" alt="" coords="413,31,525,57"/>
<area shape="rect" id="node4" href="client_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="731,5,781,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7c6bc0a015a0a78cb508614995b9172e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structhandshake__t.html">handshake_t</a>* make_client_hello </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>client_random</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcipher__suite__t.html">cipher_suite_t</a>&#160;</td>
          <td class="paramname"><em>cipher_suite_list</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cipher_suite_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given an array of cipher suite make a client hello message. The function also fill the random field using the time stamp and a random generator(openssl)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">client_random</td><td>: the random setted in the client hello </td></tr>
    <tr><td class="paramname">cipher_suite_list</td><td>: an array of cipher suite to add in the client hello </td></tr>
    <tr><td class="paramname">cipher_suite_len</td><td>: the number of cipher suite in the list </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the hello client handshake message </dd></dl>

<p>Referenced by <a class="el" href="client_8c.html#aed2d0a7b3d9f68efed058f1bc0768e95">do_handshake()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_a7c6bc0a015a0a78cb508614995b9172e_cgraph.png" border="0" usemap="#_t_l_s_8c_a7c6bc0a015a0a78cb508614995b9172e_cgraph" alt=""/></div>
<map name="_t_l_s_8c_a7c6bc0a015a0a78cb508614995b9172e_cgraph" id="_t_l_s_8c_a7c6bc0a015a0a78cb508614995b9172e_cgraph">
<area shape="rect" id="node2" href="_server_client_hello_8c.html#a095e7c0597d66b5e4eb2097b8f28474a" title="make_hello" alt="" coords="216,5,307,32"/>
<area shape="rect" id="node3" href="_server_client_hello_8c.html#a5d76fe55dc16550edc3604fcde33b8d0" title="serialize_client_server\l_hello" alt="" coords="185,57,338,98"/>
<area shape="rect" id="node4" href="_server_client_hello_8c.html#aec7721cdc08398302cd7435054202117" title="free_hello" alt="" coords="221,123,301,149"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_a7c6bc0a015a0a78cb508614995b9172e_icgraph.png" border="0" usemap="#_t_l_s_8c_a7c6bc0a015a0a78cb508614995b9172e_icgraph" alt=""/></div>
<map name="_t_l_s_8c_a7c6bc0a015a0a78cb508614995b9172e_icgraph" id="_t_l_s_8c_a7c6bc0a015a0a78cb508614995b9172e_icgraph">
<area shape="rect" id="node2" href="client_8c.html#aed2d0a7b3d9f68efed058f1bc0768e95" title="do_handshake" alt="" coords="184,5,293,32"/>
<area shape="rect" id="node3" href="client_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="341,5,392,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab3bb4e3f75fb84baa35cd0931381dfe0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structhandshake__t.html">handshake_t</a>* make_client_key_exchange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *&#160;</td>
          <td class="paramname"><em>TLS_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>key_ex_alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given the information in the TLS_parameter and the key exchange algorithm return the handshake of the client key exchange. That include compute the pre-master key. It also compute the master secret and set in the TLS_param.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TLS_param</td><td>: the parameters of the connection </td></tr>
    <tr><td class="paramname">key_ex_alg</td><td>: the key exchange algorithm of the handshake </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the client key exchange handshake message </dd></dl>

<p>Referenced by <a class="el" href="client_8c.html#a779b051aa3cf19358f7177780ce60f11">onPacketReceive()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_ab3bb4e3f75fb84baa35cd0931381dfe0_cgraph.png" border="0" usemap="#_t_l_s_8c_ab3bb4e3f75fb84baa35cd0931381dfe0_cgraph" alt=""/></div>
<map name="_t_l_s_8c_ab3bb4e3f75fb84baa35cd0931381dfe0_cgraph" id="_t_l_s_8c_ab3bb4e3f75fb84baa35cd0931381dfe0_cgraph">
<area shape="rect" id="node2" href="_t_l_s_8c.html#aef2a72a9807aac60336cd3febe51a130" title="make_RSA_client_key\l_exchange" alt="" coords="251,89,407,130"/>
<area shape="rect" id="node5" href="_t_l_s_8c.html#ace7876fa0df923e8b3c924a7a046a1ff" title="make_DHE_client_key\l_exchange" alt="" coords="251,154,408,195"/>
<area shape="rect" id="node7" href="_t_l_s_8c.html#a6f7128cf62e8491d70cf2585cf901c4c" title="make_ECDHE_client_key\l_exchange" alt="" coords="241,23,417,65"/>
<area shape="rect" id="node9" href="_server_client_key_exchange_8c.html#ae993e656dc83c25c3d5b952471a77d7d" title="serialize_client_key\l_exchange" alt="" coords="261,219,398,261"/>
<area shape="rect" id="node10" href="_server_client_key_exchange_8c.html#a29fa41af46ce9681a0fea1921f61a34a" title="free_client_key_exchange" alt="" coords="241,285,418,312"/>
<area shape="rect" id="node3" href="_t_l_s_constants_8c.html#a98e6374e1aa179c023ba0eb8bdf36196" title="get_hash_function" alt="" coords="483,71,613,97"/>
<area shape="rect" id="node4" href="_crypto_8c.html#a14bb82638713f9cf8778b58d6d64e33d" title="PRF" alt="" coords="524,121,572,148"/>
<area shape="rect" id="node6" href="_crypto_8c.html#afbf202296205717442436cd3838d6df7" title="verify_DHE_server_key\l_ex_sign" alt="" coords="467,173,629,214"/>
<area shape="rect" id="node8" href="_crypto_8c.html#a5de0523f653b00816828961ba5cc990b" title="verify_ECDHE_server\l_key_ex_sign" alt="" coords="472,5,624,46"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_ab3bb4e3f75fb84baa35cd0931381dfe0_icgraph.png" border="0" usemap="#_t_l_s_8c_ab3bb4e3f75fb84baa35cd0931381dfe0_icgraph" alt=""/></div>
<map name="_t_l_s_8c_ab3bb4e3f75fb84baa35cd0931381dfe0_icgraph" id="_t_l_s_8c_ab3bb4e3f75fb84baa35cd0931381dfe0_icgraph">
<area shape="rect" id="node2" href="client_8c.html#a779b051aa3cf19358f7177780ce60f11" title="onPacketReceive" alt="" coords="240,5,365,32"/>
<area shape="rect" id="node3" href="client_8c.html#aed2d0a7b3d9f68efed058f1bc0768e95" title="do_handshake" alt="" coords="573,5,683,32"/>
<area shape="rect" id="node5" href="_server_client_transport_protocol_8h.html#a018090dd0ba292fbef485142a080fa59" title="set_on_receive" alt="" coords="413,31,525,57"/>
<area shape="rect" id="node4" href="client_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="731,5,781,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ace7876fa0df923e8b3c924a7a046a1ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void make_DHE_client_key_exchange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *&#160;</td>
          <td class="paramname"><em>TLS_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structclient__key__exchange__t.html">client_key_exchange_t</a> *&#160;</td>
          <td class="paramname"><em>client_key_ex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Make the client key exchange message for DHE key exchange. This function is called from make_client_key_exchange if the key exchange is DHE.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">client_key_ex</td><td>: the client key exchange message </td></tr>
    <tr><td class="paramname">TLS_param</td><td>: the connection parameters </td></tr>
  </table>
  </dd>
</dl>

<p>Referenced by <a class="el" href="_t_l_s_8h.html#ab3bb4e3f75fb84baa35cd0931381dfe0">make_client_key_exchange()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_ace7876fa0df923e8b3c924a7a046a1ff_cgraph.png" border="0" usemap="#_t_l_s_8c_ace7876fa0df923e8b3c924a7a046a1ff_cgraph" alt=""/></div>
<map name="_t_l_s_8c_ace7876fa0df923e8b3c924a7a046a1ff_cgraph" id="_t_l_s_8c_ace7876fa0df923e8b3c924a7a046a1ff_cgraph">
<area shape="rect" id="node2" href="_crypto_8c.html#afbf202296205717442436cd3838d6df7" title="verify_DHE_server_key\l_ex_sign" alt="" coords="211,5,373,46"/>
<area shape="rect" id="node3" href="_t_l_s_constants_8c.html#a98e6374e1aa179c023ba0eb8bdf36196" title="get_hash_function" alt="" coords="227,71,357,97"/>
<area shape="rect" id="node4" href="_crypto_8c.html#a14bb82638713f9cf8778b58d6d64e33d" title="PRF" alt="" coords="268,121,316,148"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_ace7876fa0df923e8b3c924a7a046a1ff_icgraph.png" border="0" usemap="#_t_l_s_8c_ace7876fa0df923e8b3c924a7a046a1ff_icgraph" alt=""/></div>
<map name="_t_l_s_8c_ace7876fa0df923e8b3c924a7a046a1ff_icgraph" id="_t_l_s_8c_ace7876fa0df923e8b3c924a7a046a1ff_icgraph">
<area shape="rect" id="node2" href="_t_l_s_8h.html#ab3bb4e3f75fb84baa35cd0931381dfe0" title="make_client_key_exchange" alt="" coords="211,12,397,39"/>
<area shape="rect" id="node3" href="client_8c.html#a779b051aa3cf19358f7177780ce60f11" title="onPacketReceive" alt="" coords="445,12,571,39"/>
<area shape="rect" id="node4" href="client_8c.html#aed2d0a7b3d9f68efed058f1bc0768e95" title="do_handshake" alt="" coords="779,12,888,39"/>
<area shape="rect" id="node6" href="_server_client_transport_protocol_8h.html#a018090dd0ba292fbef485142a080fa59" title="set_on_receive" alt="" coords="619,37,731,64"/>
<area shape="rect" id="node5" href="client_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="936,12,987,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a359e2b0b51c61744f7a70b5888d8c2db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdhe__server__key__exchange__t.html">dhe_server_key_exchange_t</a>* make_DHE_server_key_exchange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *&#160;</td>
          <td class="paramname"><em>TLS_param</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Make the server key exchange for DHE key exchange. It computes the DH parameters and save the message in the connection parameters TLS_param.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TLS_param</td><td>: connection parameters </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the dhe_server_key_exchange struct </dd></dl>

<p>Referenced by <a class="el" href="_t_l_s_8h.html#a902d940508d7080023ef072b2667a143">make_server_key_exchange()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_a359e2b0b51c61744f7a70b5888d8c2db_cgraph.png" border="0" usemap="#_t_l_s_8c_a359e2b0b51c61744f7a70b5888d8c2db_cgraph" alt=""/></div>
<map name="_t_l_s_8c_a359e2b0b51c61744f7a70b5888d8c2db_cgraph" id="_t_l_s_8c_a359e2b0b51c61744f7a70b5888d8c2db_cgraph">
<area shape="rect" id="node2" href="_crypto_8c.html#aebef13db99f3bbd7e9e2c55df1aa65c9" title="sign_DHE_server_key_ex" alt="" coords="216,31,392,57"/>
<area shape="rect" id="node3" href="_crypto_8c.html#a31cb61fd4a97cf2156245c8c240dd102" title="sign_with_RSA" alt="" coords="440,5,552,32"/>
<area shape="rect" id="node4" href="_crypto_8c.html#a5c701b627116ed4a23b7aeb18617d550" title="sign_with_DSS" alt="" coords="440,56,552,83"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_a359e2b0b51c61744f7a70b5888d8c2db_icgraph.png" border="0" usemap="#_t_l_s_8c_a359e2b0b51c61744f7a70b5888d8c2db_icgraph" alt=""/></div>
<map name="_t_l_s_8c_a359e2b0b51c61744f7a70b5888d8c2db_icgraph" id="_t_l_s_8c_a359e2b0b51c61744f7a70b5888d8c2db_icgraph">
<area shape="rect" id="node2" href="_t_l_s_8h.html#a902d940508d7080023ef072b2667a143" title="make_server_key_exchange" alt="" coords="216,12,408,39"/>
<area shape="rect" id="node3" href="server_8c.html#a98d326f448510d53d67b27e5cbbad82d" title="onPacketReceive" alt="" coords="456,12,581,39"/>
<area shape="rect" id="node4" href="server_8c.html#a92b39c23154f9435d52c1bd2babb4ad9" title="do_handshake" alt="" coords="629,12,739,39"/>
<area shape="rect" id="node5" href="server_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="787,12,837,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6f7128cf62e8491d70cf2585cf901c4c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void make_ECDHE_client_key_exchange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *&#160;</td>
          <td class="paramname"><em>TLS_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structclient__key__exchange__t.html">client_key_exchange_t</a> *&#160;</td>
          <td class="paramname"><em>client_key_ex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Make the client key exchange message for ECDHE key exchange. This function is called from make_client_key_exchange if the key exchange is ECDHE.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">client_key_ex</td><td>: the client key exchange message </td></tr>
    <tr><td class="paramname">TLS_param</td><td>: the connection parameters </td></tr>
  </table>
  </dd>
</dl>

<p>Referenced by <a class="el" href="_t_l_s_8h.html#ab3bb4e3f75fb84baa35cd0931381dfe0">make_client_key_exchange()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_a6f7128cf62e8491d70cf2585cf901c4c_cgraph.png" border="0" usemap="#_t_l_s_8c_a6f7128cf62e8491d70cf2585cf901c4c_cgraph" alt=""/></div>
<map name="_t_l_s_8c_a6f7128cf62e8491d70cf2585cf901c4c_cgraph" id="_t_l_s_8c_a6f7128cf62e8491d70cf2585cf901c4c_cgraph">
<area shape="rect" id="node2" href="_crypto_8c.html#a5de0523f653b00816828961ba5cc990b" title="verify_ECDHE_server\l_key_ex_sign" alt="" coords="229,5,381,46"/>
<area shape="rect" id="node3" href="_t_l_s_constants_8c.html#a98e6374e1aa179c023ba0eb8bdf36196" title="get_hash_function" alt="" coords="240,71,371,97"/>
<area shape="rect" id="node4" href="_crypto_8c.html#a14bb82638713f9cf8778b58d6d64e33d" title="PRF" alt="" coords="281,121,329,148"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_a6f7128cf62e8491d70cf2585cf901c4c_icgraph.png" border="0" usemap="#_t_l_s_8c_a6f7128cf62e8491d70cf2585cf901c4c_icgraph" alt=""/></div>
<map name="_t_l_s_8c_a6f7128cf62e8491d70cf2585cf901c4c_icgraph" id="_t_l_s_8c_a6f7128cf62e8491d70cf2585cf901c4c_icgraph">
<area shape="rect" id="node2" href="_t_l_s_8h.html#ab3bb4e3f75fb84baa35cd0931381dfe0" title="make_client_key_exchange" alt="" coords="229,12,416,39"/>
<area shape="rect" id="node3" href="client_8c.html#a779b051aa3cf19358f7177780ce60f11" title="onPacketReceive" alt="" coords="464,12,589,39"/>
<area shape="rect" id="node4" href="client_8c.html#aed2d0a7b3d9f68efed058f1bc0768e95" title="do_handshake" alt="" coords="797,12,907,39"/>
<area shape="rect" id="node6" href="_server_client_transport_protocol_8h.html#a018090dd0ba292fbef485142a080fa59" title="set_on_receive" alt="" coords="637,37,749,64"/>
<area shape="rect" id="node5" href="client_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="955,12,1005,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ade6994e7ea30d8b5b89b2cd551101db4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structecdhe__server__key__exchange__t.html">ecdhe_server_key_exchange_t</a>* make_ECDHE_server_key_exchange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *&#160;</td>
          <td class="paramname"><em>TLS_param</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Make the server key exchange for ECDHE key exchange. It computes the ECDHE parameters using the secp256k1 curve and save the message in the connection parameters TLS_param.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TLS_param</td><td>: connection parameters </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the ecdhe_server_key_exchange struct </dd></dl>

<p>Referenced by <a class="el" href="_t_l_s_8h.html#a902d940508d7080023ef072b2667a143">make_server_key_exchange()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_ade6994e7ea30d8b5b89b2cd551101db4_cgraph.png" border="0" usemap="#_t_l_s_8c_ade6994e7ea30d8b5b89b2cd551101db4_cgraph" alt=""/></div>
<map name="_t_l_s_8c_ade6994e7ea30d8b5b89b2cd551101db4_cgraph" id="_t_l_s_8c_ade6994e7ea30d8b5b89b2cd551101db4_cgraph">
<area shape="rect" id="node2" href="_crypto_8c.html#abe36fc162d9170d061024842f7ec6b9d" title="sign_ECDHE_server_key_ex" alt="" coords="235,31,429,57"/>
<area shape="rect" id="node3" href="_crypto_8c.html#a31cb61fd4a97cf2156245c8c240dd102" title="sign_with_RSA" alt="" coords="487,5,599,32"/>
<area shape="rect" id="node4" href="_crypto_8c.html#a0dd93ef4efe1bae339c50df2b284f3f8" title="sign_with_ECDSA" alt="" coords="477,56,608,83"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_ade6994e7ea30d8b5b89b2cd551101db4_icgraph.png" border="0" usemap="#_t_l_s_8c_ade6994e7ea30d8b5b89b2cd551101db4_icgraph" alt=""/></div>
<map name="_t_l_s_8c_ade6994e7ea30d8b5b89b2cd551101db4_icgraph" id="_t_l_s_8c_ade6994e7ea30d8b5b89b2cd551101db4_icgraph">
<area shape="rect" id="node2" href="_t_l_s_8h.html#a902d940508d7080023ef072b2667a143" title="make_server_key_exchange" alt="" coords="235,12,427,39"/>
<area shape="rect" id="node3" href="server_8c.html#a98d326f448510d53d67b27e5cbbad82d" title="onPacketReceive" alt="" coords="475,12,600,39"/>
<area shape="rect" id="node4" href="server_8c.html#a92b39c23154f9435d52c1bd2babb4ad9" title="do_handshake" alt="" coords="648,12,757,39"/>
<area shape="rect" id="node5" href="server_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="805,12,856,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae149244e09cbbd2180bc4c5fc6d0a924"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structhandshake__t.html">handshake_t</a>* make_finished_message </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *&#160;</td>
          <td class="paramname"><em>TLS_param</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given the connection parameters compute the finished message. Note in the TLS protocol this message is encrypted.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TLS_param</td><td>: the connection parameters </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the finished handshake message </dd></dl>

<p>Referenced by <a class="el" href="client_8c.html#a779b051aa3cf19358f7177780ce60f11">onPacketReceive()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_ae149244e09cbbd2180bc4c5fc6d0a924_cgraph.png" border="0" usemap="#_t_l_s_8c_ae149244e09cbbd2180bc4c5fc6d0a924_cgraph" alt=""/></div>
<map name="_t_l_s_8c_ae149244e09cbbd2180bc4c5fc6d0a924_cgraph" id="_t_l_s_8c_ae149244e09cbbd2180bc4c5fc6d0a924_cgraph">
<area shape="rect" id="node2" href="_t_l_s_constants_8c.html#a98e6374e1aa179c023ba0eb8bdf36196" title="get_hash_function" alt="" coords="224,5,355,32"/>
<area shape="rect" id="node3" href="_crypto_8c.html#a14bb82638713f9cf8778b58d6d64e33d" title="PRF" alt="" coords="265,56,313,83"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_ae149244e09cbbd2180bc4c5fc6d0a924_icgraph.png" border="0" usemap="#_t_l_s_8c_ae149244e09cbbd2180bc4c5fc6d0a924_icgraph" alt=""/></div>
<map name="_t_l_s_8c_ae149244e09cbbd2180bc4c5fc6d0a924_icgraph" id="_t_l_s_8c_ae149244e09cbbd2180bc4c5fc6d0a924_icgraph">
<area shape="rect" id="node2" href="client_8c.html#a779b051aa3cf19358f7177780ce60f11" title="onPacketReceive" alt="" coords="224,5,349,32"/>
<area shape="rect" id="node3" href="client_8c.html#aed2d0a7b3d9f68efed058f1bc0768e95" title="do_handshake" alt="" coords="557,5,667,32"/>
<area shape="rect" id="node5" href="_server_client_transport_protocol_8h.html#a018090dd0ba292fbef485142a080fa59" title="set_on_receive" alt="" coords="397,31,509,57"/>
<area shape="rect" id="node4" href="client_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="715,5,765,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aef2a72a9807aac60336cd3febe51a130"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void make_RSA_client_key_exchange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *&#160;</td>
          <td class="paramname"><em>TLS_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structclient__key__exchange__t.html">client_key_exchange_t</a> *&#160;</td>
          <td class="paramname"><em>client_key_ex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Make the client key exchange message for RSA key exchange. This function is called from make_client_key_exchange if the key exchange is RSA.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">client_key_ex</td><td>: the client key exchange message </td></tr>
    <tr><td class="paramname">TLS_param</td><td>: the connection parameters </td></tr>
  </table>
  </dd>
</dl>

<p>Referenced by <a class="el" href="_t_l_s_8h.html#ab3bb4e3f75fb84baa35cd0931381dfe0">make_client_key_exchange()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_aef2a72a9807aac60336cd3febe51a130_cgraph.png" border="0" usemap="#_t_l_s_8c_aef2a72a9807aac60336cd3febe51a130_cgraph" alt=""/></div>
<map name="_t_l_s_8c_aef2a72a9807aac60336cd3febe51a130_cgraph" id="_t_l_s_8c_aef2a72a9807aac60336cd3febe51a130_cgraph">
<area shape="rect" id="node2" href="_t_l_s_constants_8c.html#a98e6374e1aa179c023ba0eb8bdf36196" title="get_hash_function" alt="" coords="211,5,341,32"/>
<area shape="rect" id="node3" href="_crypto_8c.html#a14bb82638713f9cf8778b58d6d64e33d" title="PRF" alt="" coords="252,56,300,83"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_aef2a72a9807aac60336cd3febe51a130_icgraph.png" border="0" usemap="#_t_l_s_8c_aef2a72a9807aac60336cd3febe51a130_icgraph" alt=""/></div>
<map name="_t_l_s_8c_aef2a72a9807aac60336cd3febe51a130_icgraph" id="_t_l_s_8c_aef2a72a9807aac60336cd3febe51a130_icgraph">
<area shape="rect" id="node2" href="_t_l_s_8h.html#ab3bb4e3f75fb84baa35cd0931381dfe0" title="make_client_key_exchange" alt="" coords="211,12,397,39"/>
<area shape="rect" id="node3" href="client_8c.html#a779b051aa3cf19358f7177780ce60f11" title="onPacketReceive" alt="" coords="445,12,571,39"/>
<area shape="rect" id="node4" href="client_8c.html#aed2d0a7b3d9f68efed058f1bc0768e95" title="do_handshake" alt="" coords="779,12,888,39"/>
<area shape="rect" id="node6" href="_server_client_transport_protocol_8h.html#a018090dd0ba292fbef485142a080fa59" title="set_on_receive" alt="" coords="619,37,731,64"/>
<area shape="rect" id="node5" href="client_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="936,12,987,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a035a830fd89c6c7af60809197d81ea29"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structhandshake__t.html">handshake_t</a>* make_server_hello </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *&#160;</td>
          <td class="paramname"><em>TLS_param</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structserver__client__hello__t.html">server_client_hello_t</a> *&#160;</td>
          <td class="paramname"><em>client_hello</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Given the client hello message the function makes the server hello. It choices a random cipher suite among the those provided by the client. The function also fill the random field using the time stamp and a random generator(openssl)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TLS_param</td><td>: the connection parameters </td></tr>
    <tr><td class="paramname">client_hello</td><td>: the received client hello. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the hello server handshake message </dd></dl>

<p>Referenced by <a class="el" href="server_8c.html#a98d326f448510d53d67b27e5cbbad82d">onPacketReceive()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_a035a830fd89c6c7af60809197d81ea29_cgraph.png" border="0" usemap="#_t_l_s_8c_a035a830fd89c6c7af60809197d81ea29_cgraph" alt=""/></div>
<map name="_t_l_s_8c_a035a830fd89c6c7af60809197d81ea29_cgraph" id="_t_l_s_8c_a035a830fd89c6c7af60809197d81ea29_cgraph">
<area shape="rect" id="node2" href="_server_client_hello_8c.html#a095e7c0597d66b5e4eb2097b8f28474a" title="make_hello" alt="" coords="224,5,315,32"/>
<area shape="rect" id="node3" href="_t_l_s_constants_8c.html#a7f66c07120c851032c213bdadcff2009" title="get_cipher_suite_by_id" alt="" coords="190,56,349,83"/>
<area shape="rect" id="node4" href="_server_client_hello_8c.html#a5d76fe55dc16550edc3604fcde33b8d0" title="serialize_client_server\l_hello" alt="" coords="193,107,346,149"/>
<area shape="rect" id="node5" href="_server_client_hello_8c.html#aec7721cdc08398302cd7435054202117" title="free_hello" alt="" coords="229,173,309,200"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_a035a830fd89c6c7af60809197d81ea29_icgraph.png" border="0" usemap="#_t_l_s_8c_a035a830fd89c6c7af60809197d81ea29_icgraph" alt=""/></div>
<map name="_t_l_s_8c_a035a830fd89c6c7af60809197d81ea29_icgraph" id="_t_l_s_8c_a035a830fd89c6c7af60809197d81ea29_icgraph">
<area shape="rect" id="node2" href="server_8c.html#a98d326f448510d53d67b27e5cbbad82d" title="onPacketReceive" alt="" coords="189,5,315,32"/>
<area shape="rect" id="node3" href="server_8c.html#a92b39c23154f9435d52c1bd2babb4ad9" title="do_handshake" alt="" coords="363,5,472,32"/>
<area shape="rect" id="node4" href="server_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="520,5,571,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af98aa49e2563d588c366ef1712de925a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structhandshake__t.html">handshake_t</a>* make_server_hello_done </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Make the server hello done message. This message is simple and doesn't require any parameter.</p>
<dl class="section return"><dt>Returns</dt><dd>the server hello done handshake message </dd></dl>

<p>Referenced by <a class="el" href="server_8c.html#a98d326f448510d53d67b27e5cbbad82d">onPacketReceive()</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_af98aa49e2563d588c366ef1712de925a_icgraph.png" border="0" usemap="#_t_l_s_8c_af98aa49e2563d588c366ef1712de925a_icgraph" alt=""/></div>
<map name="_t_l_s_8c_af98aa49e2563d588c366ef1712de925a_icgraph" id="_t_l_s_8c_af98aa49e2563d588c366ef1712de925a_icgraph">
<area shape="rect" id="node2" href="server_8c.html#a98d326f448510d53d67b27e5cbbad82d" title="onPacketReceive" alt="" coords="227,5,352,32"/>
<area shape="rect" id="node3" href="server_8c.html#a92b39c23154f9435d52c1bd2babb4ad9" title="do_handshake" alt="" coords="400,5,509,32"/>
<area shape="rect" id="node4" href="server_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="557,5,608,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a902d940508d7080023ef072b2667a143"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structhandshake__t.html">handshake_t</a>* make_server_key_exchange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_t_l_s__parameters__t.html">TLS_parameters_t</a> *&#160;</td>
          <td class="paramname"><em>TLS_param</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Make the server key exchange handshake message. The function also sets the message in the connection parameters for compute the master key in the client key exchange message.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">TLS_param</td><td>: connection parameters </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the server key exchange handshake message </dd></dl>

<p>Referenced by <a class="el" href="server_8c.html#a98d326f448510d53d67b27e5cbbad82d">onPacketReceive()</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_a902d940508d7080023ef072b2667a143_cgraph.png" border="0" usemap="#_t_l_s_8c_a902d940508d7080023ef072b2667a143_cgraph" alt=""/></div>
<map name="_t_l_s_8c_a902d940508d7080023ef072b2667a143_cgraph" id="_t_l_s_8c_a902d940508d7080023ef072b2667a143_cgraph">
<area shape="rect" id="node2" href="_t_l_s_8c.html#a359e2b0b51c61744f7a70b5888d8c2db" title="make_DHE_server_key\l_exchange" alt="" coords="255,17,417,58"/>
<area shape="rect" id="node6" href="_t_l_s_8c.html#ade6994e7ea30d8b5b89b2cd551101db4" title="make_ECDHE_server_key\l_exchange" alt="" coords="245,82,427,123"/>
<area shape="rect" id="node9" href="_server_client_key_exchange_8c.html#a8cb71f83bed21f1dd9bb8cdb9dca1e5f" title="serialize_server_key\l_exchange" alt="" coords="264,147,408,189"/>
<area shape="rect" id="node3" href="_crypto_8c.html#aebef13db99f3bbd7e9e2c55df1aa65c9" title="sign_DHE_server_key_ex" alt="" coords="484,24,660,51"/>
<area shape="rect" id="node4" href="_crypto_8c.html#a31cb61fd4a97cf2156245c8c240dd102" title="sign_with_RSA" alt="" coords="727,56,839,83"/>
<area shape="rect" id="node5" href="_crypto_8c.html#a5c701b627116ed4a23b7aeb18617d550" title="sign_with_DSS" alt="" coords="727,5,839,32"/>
<area shape="rect" id="node7" href="_crypto_8c.html#abe36fc162d9170d061024842f7ec6b9d" title="sign_ECDHE_server_key_ex" alt="" coords="475,89,669,116"/>
<area shape="rect" id="node8" href="_crypto_8c.html#a0dd93ef4efe1bae339c50df2b284f3f8" title="sign_with_ECDSA" alt="" coords="717,107,848,133"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_t_l_s_8c_a902d940508d7080023ef072b2667a143_icgraph.png" border="0" usemap="#_t_l_s_8c_a902d940508d7080023ef072b2667a143_icgraph" alt=""/></div>
<map name="_t_l_s_8c_a902d940508d7080023ef072b2667a143_icgraph" id="_t_l_s_8c_a902d940508d7080023ef072b2667a143_icgraph">
<area shape="rect" id="node2" href="server_8c.html#a98d326f448510d53d67b27e5cbbad82d" title="onPacketReceive" alt="" coords="245,5,371,32"/>
<area shape="rect" id="node3" href="server_8c.html#a92b39c23154f9435d52c1bd2babb4ad9" title="do_handshake" alt="" coords="419,5,528,32"/>
<area shape="rect" id="node4" href="server_8c.html#a3c04138a5bfe5d72780bb7e82a18e627" title="main" alt="" coords="576,5,627,32"/>
</map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
