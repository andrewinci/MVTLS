\hypertarget{server_8c}{}\section{src/\+Target/server.c File Reference}
\label{server_8c}\index{src/\+Target/server.\+c@{src/\+Target/server.\+c}}
{\ttfamily \#include $<$stdio.\+h$>$}\\*
{\ttfamily \#include \char`\"{}T\+L\+S.\+h\char`\"{}}\\*
Include dependency graph for server.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{server_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{server_8c_a56fe9bff0a1be75aae2da3e593053e2c}{U\+S\+A\+GE}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{server_8c_abee2be16a3aea34a85c91e18d0173b64}{print\+\_\+random} ()
\item 
void \hyperlink{server_8c_a316d68a624ee269df15d44339c421e1c}{print\+\_\+master\+\_\+secret} ()
\item 
void \hyperlink{server_8c_afd393872efb6c56e1f6ab8624978d430}{compute\+\_\+set\+\_\+master\+\_\+key\+\_\+\+R\+SA} (\hyperlink{structclient__key__exchange__t}{client\+\_\+key\+\_\+exchange\+\_\+t} $\ast$client\+\_\+key\+\_\+exchange)
\item 
void \hyperlink{server_8c_af952fb7c680b797eb1bf2d7bb568da8c}{compute\+\_\+set\+\_\+master\+\_\+key\+\_\+\+D\+HE} (\hyperlink{structclient__key__exchange__t}{client\+\_\+key\+\_\+exchange\+\_\+t} $\ast$client\+\_\+key\+\_\+exchange)
\item 
void \hyperlink{server_8c_ad16c20492f567102f074f1f22116cc52}{compute\+\_\+set\+\_\+master\+\_\+key\+\_\+\+E\+C\+D\+HE} (\hyperlink{structclient__key__exchange__t}{client\+\_\+key\+\_\+exchange\+\_\+t} $\ast$client\+\_\+key\+\_\+exchange)
\item 
void \hyperlink{server_8c_a48f2c3c739d443cf2dd46c01a7136674}{on\+Packet\+Receive} (\hyperlink{structchannel__t}{channel\+\_\+t} $\ast$\hyperlink{structchannel}{channel}, \hyperlink{structpacket__transport__t}{packet\+\_\+transport\+\_\+t} $\ast$p)
\item 
void \hyperlink{server_8c_a92b39c23154f9435d52c1bd2babb4ad9}{do\+\_\+handshake} ()
\item 
int \hyperlink{server_8c_a3c04138a5bfe5d72780bb7e82a18e627}{main} (int argc, char $\ast$$\ast$argv)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{server_8c_a1bdcfae3209cbd96db35a2ae356fa15e}{verbosity} = 0
\item 
\hyperlink{struct_t_l_s__parameters__t}{T\+L\+S\+\_\+parameters\+\_\+t} \hyperlink{server_8c_aa8eef32066e04e25183a0cc549992c54}{T\+L\+S\+\_\+param}
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\index{server.\+c@{server.\+c}!U\+S\+A\+GE@{U\+S\+A\+GE}}
\index{U\+S\+A\+GE@{U\+S\+A\+GE}!server.\+c@{server.\+c}}
\subsubsection[{\texorpdfstring{U\+S\+A\+GE}{USAGE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define U\+S\+A\+GE}\hypertarget{server_8c_a56fe9bff0a1be75aae2da3e593053e2c}{}\label{server_8c_a56fe9bff0a1be75aae2da3e593053e2c}
{\bfseries Value\+:}
\begin{DoxyCode}
\textcolor{stringliteral}{"TLSClient: TLS1.2 version handshake\(\backslash\)n"}\(\backslash\)
                \textcolor{stringliteral}{"\(\backslash\)n"}\(\backslash\)
                \textcolor{stringliteral}{"Usage:\(\backslash\)n"}\(\backslash\)
                \textcolor{stringliteral}{" TLSServer [args]\(\backslash\)n"}\(\backslash\)
                \textcolor{stringliteral}{"\(\backslash\)n"}\(\backslash\)
                \textcolor{stringliteral}{"Options: \(\backslash\)n"}\(\backslash\)
                \textcolor{stringliteral}{" Set verbosity\(\backslash\)n"}\(\backslash\)
                \textcolor{stringliteral}{"   -v              (0 default only handshake name \(\backslash\)n"}\(\backslash\)
                \textcolor{stringliteral}{"                   |1 handshake binary\(\backslash\)n"}\(\backslash\)
                \textcolor{stringliteral}{"                   |2 handshake binary and mesages description\(\backslash\)n"}\(\backslash\)
                \textcolor{stringliteral}{"                   |3 record bynary and messages description)\(\backslash\)n"}\(\backslash\)
                \textcolor{stringliteral}{"\(\backslash\)n"}\(\backslash\)
                \textcolor{stringliteral}{" Show this help\(\backslash\)n"}\(\backslash\)
                \textcolor{stringliteral}{"   --help\(\backslash\)n\(\backslash\)n"}
\end{DoxyCode}
String with program arguments 

Referenced by main().



\subsection{Function Documentation}
\index{server.\+c@{server.\+c}!compute\+\_\+set\+\_\+master\+\_\+key\+\_\+\+D\+HE@{compute\+\_\+set\+\_\+master\+\_\+key\+\_\+\+D\+HE}}
\index{compute\+\_\+set\+\_\+master\+\_\+key\+\_\+\+D\+HE@{compute\+\_\+set\+\_\+master\+\_\+key\+\_\+\+D\+HE}!server.\+c@{server.\+c}}
\subsubsection[{\texorpdfstring{compute\+\_\+set\+\_\+master\+\_\+key\+\_\+\+D\+H\+E(client\+\_\+key\+\_\+exchange\+\_\+t $\ast$client\+\_\+key\+\_\+exchange)}{compute_set_master_key_DHE(client_key_exchange_t *client_key_exchange)}}]{\setlength{\rightskip}{0pt plus 5cm}void compute\+\_\+set\+\_\+master\+\_\+key\+\_\+\+D\+HE (
\begin{DoxyParamCaption}
\item[{{\bf client\+\_\+key\+\_\+exchange\+\_\+t} $\ast$}]{client\+\_\+key\+\_\+exchange}
\end{DoxyParamCaption}
)}\hypertarget{server_8c_af952fb7c680b797eb1bf2d7bb568da8c}{}\label{server_8c_af952fb7c680b797eb1bf2d7bb568da8c}
Compute the master key for D\+HE using the previous server key exchange stored in T\+L\+S\+\_\+param and the client key exchange. The master key, master key length is stored also in T\+L\+S\+\_\+param.


\begin{DoxyParams}{Parameters}
{\em client\+\_\+key\+\_\+exchange} & the client key exchange sent by client \\
\hline
\end{DoxyParams}


Referenced by on\+Packet\+Receive().



Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=324pt]{server_8c_af952fb7c680b797eb1bf2d7bb568da8c_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{server_8c_af952fb7c680b797eb1bf2d7bb568da8c_icgraph}
\end{center}
\end{figure}


\index{server.\+c@{server.\+c}!compute\+\_\+set\+\_\+master\+\_\+key\+\_\+\+E\+C\+D\+HE@{compute\+\_\+set\+\_\+master\+\_\+key\+\_\+\+E\+C\+D\+HE}}
\index{compute\+\_\+set\+\_\+master\+\_\+key\+\_\+\+E\+C\+D\+HE@{compute\+\_\+set\+\_\+master\+\_\+key\+\_\+\+E\+C\+D\+HE}!server.\+c@{server.\+c}}
\subsubsection[{\texorpdfstring{compute\+\_\+set\+\_\+master\+\_\+key\+\_\+\+E\+C\+D\+H\+E(client\+\_\+key\+\_\+exchange\+\_\+t $\ast$client\+\_\+key\+\_\+exchange)}{compute_set_master_key_ECDHE(client_key_exchange_t *client_key_exchange)}}]{\setlength{\rightskip}{0pt plus 5cm}void compute\+\_\+set\+\_\+master\+\_\+key\+\_\+\+E\+C\+D\+HE (
\begin{DoxyParamCaption}
\item[{{\bf client\+\_\+key\+\_\+exchange\+\_\+t} $\ast$}]{client\+\_\+key\+\_\+exchange}
\end{DoxyParamCaption}
)}\hypertarget{server_8c_ad16c20492f567102f074f1f22116cc52}{}\label{server_8c_ad16c20492f567102f074f1f22116cc52}
Compute the master key for E\+C\+D\+HE using the previous server key exchange stored in T\+L\+S\+\_\+param and the client key exchange. The master key, master key length is stored also in T\+L\+S\+\_\+param.


\begin{DoxyParams}{Parameters}
{\em client\+\_\+key\+\_\+exchange} & the client key exchange sent by client \\
\hline
\end{DoxyParams}


Referenced by on\+Packet\+Receive().



Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=324pt]{server_8c_ad16c20492f567102f074f1f22116cc52_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{server_8c_ad16c20492f567102f074f1f22116cc52_icgraph}
\end{center}
\end{figure}


\index{server.\+c@{server.\+c}!compute\+\_\+set\+\_\+master\+\_\+key\+\_\+\+R\+SA@{compute\+\_\+set\+\_\+master\+\_\+key\+\_\+\+R\+SA}}
\index{compute\+\_\+set\+\_\+master\+\_\+key\+\_\+\+R\+SA@{compute\+\_\+set\+\_\+master\+\_\+key\+\_\+\+R\+SA}!server.\+c@{server.\+c}}
\subsubsection[{\texorpdfstring{compute\+\_\+set\+\_\+master\+\_\+key\+\_\+\+R\+S\+A(client\+\_\+key\+\_\+exchange\+\_\+t $\ast$client\+\_\+key\+\_\+exchange)}{compute_set_master_key_RSA(client_key_exchange_t *client_key_exchange)}}]{\setlength{\rightskip}{0pt plus 5cm}void compute\+\_\+set\+\_\+master\+\_\+key\+\_\+\+R\+SA (
\begin{DoxyParamCaption}
\item[{{\bf client\+\_\+key\+\_\+exchange\+\_\+t} $\ast$}]{client\+\_\+key\+\_\+exchange}
\end{DoxyParamCaption}
)}\hypertarget{server_8c_afd393872efb6c56e1f6ab8624978d430}{}\label{server_8c_afd393872efb6c56e1f6ab8624978d430}
Compute the master key for R\+SA using the previous server key exchange stored in T\+L\+S\+\_\+param and the client key exchange. The master key, master key length is stored also in T\+L\+S\+\_\+param.


\begin{DoxyParams}{Parameters}
{\em client\+\_\+key\+\_\+exchange} & the client key exchange sent by client \\
\hline
\end{DoxyParams}


Referenced by on\+Packet\+Receive().



Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=324pt]{server_8c_afd393872efb6c56e1f6ab8624978d430_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{server_8c_afd393872efb6c56e1f6ab8624978d430_icgraph}
\end{center}
\end{figure}


\index{server.\+c@{server.\+c}!do\+\_\+handshake@{do\+\_\+handshake}}
\index{do\+\_\+handshake@{do\+\_\+handshake}!server.\+c@{server.\+c}}
\subsubsection[{\texorpdfstring{do\+\_\+handshake()}{do_handshake()}}]{\setlength{\rightskip}{0pt plus 5cm}void do\+\_\+handshake (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{server_8c_a92b39c23154f9435d52c1bd2babb4ad9}{}\label{server_8c_a92b39c23154f9435d52c1bd2babb4ad9}
Do the handshake 

Referenced by main().



Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{server_8c_a92b39c23154f9435d52c1bd2babb4ad9_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=236pt]{server_8c_a92b39c23154f9435d52c1bd2babb4ad9_icgraph}
\end{center}
\end{figure}


\index{server.\+c@{server.\+c}!main@{main}}
\index{main@{main}!server.\+c@{server.\+c}}
\subsubsection[{\texorpdfstring{main(int argc, char $\ast$$\ast$argv)}{main(int argc, char **argv)}}]{\setlength{\rightskip}{0pt plus 5cm}int main (
\begin{DoxyParamCaption}
\item[{int}]{argc, }
\item[{char $\ast$$\ast$}]{argv}
\end{DoxyParamCaption}
)}\hypertarget{server_8c_a3c04138a5bfe5d72780bb7e82a18e627}{}\label{server_8c_a3c04138a5bfe5d72780bb7e82a18e627}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{server_8c_a3c04138a5bfe5d72780bb7e82a18e627_cgraph}
\end{center}
\end{figure}


\index{server.\+c@{server.\+c}!on\+Packet\+Receive@{on\+Packet\+Receive}}
\index{on\+Packet\+Receive@{on\+Packet\+Receive}!server.\+c@{server.\+c}}
\subsubsection[{\texorpdfstring{on\+Packet\+Receive(channel\+\_\+t $\ast$channel, packet\+\_\+transport\+\_\+t $\ast$p)}{onPacketReceive(channel_t *channel, packet_transport_t *p)}}]{\setlength{\rightskip}{0pt plus 5cm}void on\+Packet\+Receive (
\begin{DoxyParamCaption}
\item[{{\bf channel\+\_\+t} $\ast$}]{channel, }
\item[{{\bf packet\+\_\+transport\+\_\+t} $\ast$}]{p}
\end{DoxyParamCaption}
)}\hypertarget{server_8c_a48f2c3c739d443cf2dd46c01a7136674}{}\label{server_8c_a48f2c3c739d443cf2dd46c01a7136674}
Function called from transport protocol when a message is received


\begin{DoxyParams}{Parameters}
{\em channel} & the communication channel \\
\hline
{\em p} & the received packet \\
\hline
\end{DoxyParams}


Referenced by do\+\_\+handshake().



Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{server_8c_a48f2c3c739d443cf2dd46c01a7136674_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{server_8c_a48f2c3c739d443cf2dd46c01a7136674_icgraph}
\end{center}
\end{figure}


\index{server.\+c@{server.\+c}!print\+\_\+master\+\_\+secret@{print\+\_\+master\+\_\+secret}}
\index{print\+\_\+master\+\_\+secret@{print\+\_\+master\+\_\+secret}!server.\+c@{server.\+c}}
\subsubsection[{\texorpdfstring{print\+\_\+master\+\_\+secret()}{print_master_secret()}}]{\setlength{\rightskip}{0pt plus 5cm}void print\+\_\+master\+\_\+secret (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{server_8c_a316d68a624ee269df15d44339c421e1c}{}\label{server_8c_a316d68a624ee269df15d44339c421e1c}
\index{server.\+c@{server.\+c}!print\+\_\+random@{print\+\_\+random}}
\index{print\+\_\+random@{print\+\_\+random}!server.\+c@{server.\+c}}
\subsubsection[{\texorpdfstring{print\+\_\+random()}{print_random()}}]{\setlength{\rightskip}{0pt plus 5cm}void print\+\_\+random (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{server_8c_abee2be16a3aea34a85c91e18d0173b64}{}\label{server_8c_abee2be16a3aea34a85c91e18d0173b64}


\subsection{Variable Documentation}
\index{server.\+c@{server.\+c}!T\+L\+S\+\_\+param@{T\+L\+S\+\_\+param}}
\index{T\+L\+S\+\_\+param@{T\+L\+S\+\_\+param}!server.\+c@{server.\+c}}
\subsubsection[{\texorpdfstring{T\+L\+S\+\_\+param}{TLS_param}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf T\+L\+S\+\_\+parameters\+\_\+t} T\+L\+S\+\_\+param}\hypertarget{server_8c_aa8eef32066e04e25183a0cc549992c54}{}\label{server_8c_aa8eef32066e04e25183a0cc549992c54}
connection parameters \index{server.\+c@{server.\+c}!verbosity@{verbosity}}
\index{verbosity@{verbosity}!server.\+c@{server.\+c}}
\subsubsection[{\texorpdfstring{verbosity}{verbosity}}]{\setlength{\rightskip}{0pt plus 5cm}int verbosity = 0}\hypertarget{server_8c_a1bdcfae3209cbd96db35a2ae356fa15e}{}\label{server_8c_a1bdcfae3209cbd96db35a2ae356fa15e}
verbosity of the output 

Referenced by main(), and on\+Packet\+Receive().

