#SSL/TLS project note
[<img src="http://www.slashroot.in/sites/default/files/ssl%20handshake%20protocol.png">]
##Record Layer
Il record è l'unità di base composta da 5 byte:
### Type(1Byte): 
Specifica il tipo di record, si hanno 4 tipi di record:
+ Handshake (0x16): Per lo scambio chiave
+ Change Cipher Spec (0x14) :Specifica il cambio cipher, non è cifrato, effettuato dopo lo scambio chiave. Da questo pacchetto in poi siamo sotto il protocollo e tutto è cifrato
+ Alert (0x15) : Qualcosa è andato storto (può avvenire anche durante l'handshake)
+ Application Data (0x17) :Scambio dati sotto il protocollo

### Version(2Byte)
Specifica la versione del protocollo: (da vedere con quali byte si indica)
forse 1Byte per major e 1 byte per minor.
Alcuni sono:
SSL 3.0                   3,0  0x0300
TLS 1.0                   3,1  0x0301
TLS 1.1                   3,2  0x0302
TLS 1.2                   3,3  0x0303

### Length (2Byte)
La lunghezza in byte del messaggio escluso l'header. 

##Handshake Layer
L'handshake è un layer sopra il record, autoesplicativo a cosa serve.
Il formato del protocollo è:
### Type (1 Byte)
Si utilizzano i seguenti messaggi:
+ HELLO_REQUEST            0   (x'00')
+ CLIENT_HELLO             1   (x'01')
+ SERVER_HELLO             2   (x'02')
+ CERTIFICATE             11   (x'0B')
+ SERVER_KEY_EXCHANGE     12   (x'0C')
+ CERTIFICATE_REQUEST     13   (x'0D')
+ SERVER_DONE             14   (x'0E')
+ CERTIFICATE_VERIFY      15   (x'0F')
+ CLIENT_KEY_EXCHANGE     16   (x'10')
+ FINISHED                20   (x'14') 

###Length (3 Byte) 
    Ma che cazzata, la lunghezza del messaggio è in 3 byte ma è contenuto 
    in uno la cui lunghezza è in 2 byte...

###Version (2 Byte)


###


non appendiamo zeri perché tanto ci pensa chi sta sotto (TCP/IP)
#da vedere:
+ (se c'è tempo)extension : http://www.iana.org/assignments/tls-extensiontype-values/tls-extensiontype-values.xhtml
poiché il protocollo non supporta alcuni dettagli (come il nome del server ed altro (vedi link)) abbiamo le estensioni.
Nel link alcune(??) estensioni supportate, il primo numero è l'identificatore che è posto all'inizio dell'estensione

general with packet spec : http://blog.fourthbit.com/2014/12/23/traffic-analysis-of-an-ssl-slash-tls-session
